<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Richard de Rozario" />
  <meta name="date" content="2015-03-09" />
  <meta name="keywords" content="operational risk, systemic events, modeling, R-code" />
  <meta name="description" content="One of the most significant things that the Basel II accord did for Operational Risk was to call attention to its heavy tailed nature. An organisation may have years of almost trivial losses, and then experience a loss event that is hundreds of times larger. This characteristic of rare and very large losses presents quite a challenge to quantitative models. Even fitting the data to heavy-tailed distributions doesn’t usually solve the problem, and most loss-distribution based models will try to model the tail events separately. However, there is not a lot of theory underneath the modelling that explains why the tail might be different. A possible explanation is hinted at in casual conversation about operational losses, namely “systemic events” – where multiple unit components (like multiple transactions, multiple customers, or multiple businesses) are affected by a single event. In this blog post, I show with some simulations that systemic events could “hide” in the tail of ordinary loss distributions. Most loss-distribution approaches do not try to capture the underlying mechanism that might explain why the tail is different. However, without representing such mechanisms, such as systemic loss events, the models are risking their validity." />
  <title>Systemic events</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; }
code > span.dt { color: #204a87; }
code > span.dv { color: #0000cf; }
code > span.bn { color: #0000cf; }
code > span.fl { color: #0000cf; }
code > span.ch { color: #4e9a06; }
code > span.st { color: #4e9a06; }
code > span.co { color: #8f5902; font-style: italic; }
code > span.ot { color: #8f5902; }
code > span.al { color: #ef2929; }
code > span.fu { color: #000000; }
code > span.er { font-weight: bold; }
  </style>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<div id="header">
<h1 class="title">Systemic events</h1>
<h3 class="date">2015-03-09</h3>
</div>
<p>One of the most significant things that the Basel II accord did for Operational Risk was to call attention to its heavy tailed nature. An organisation may have years of almost trivial losses, and then experience a loss event that is hundreds of times larger. This characteristic of rare and very large losses presents quite a challenge to quantitative models. Even fitting the data to heavy-tailed distributions doesn’t usually solve the problem, and most loss-distribution based models will try to model the tail events separately. However, there is not a lot of theory underneath the modelling that explains why the tail might be different.</p>
<p>There is a lot of talk about mixture models, lack of data, correlations and so forth, but I wondered what a mechanism might be that would justify our supposition that the tail events are fundamentally different, yet intrinsically tied to the other losses. A possible explanation is hinted at in casual conversation about operational losses, namely “systemic events” – where multiple unit components (like multiple transactions, multiple customers, or multiple businesses) are affected by a single event.</p>
<p>For example, imagine a payments process. The stream of individual transactions will experience occasional losses, typically due to keying errors or similar mistakes. However, the process is also part of a network of other processes, such as customer on-boarding, setting fee and interest rates, and so forth. In hierarchical fashion, some processes can affect multiple lower level transactions.</p>
<p>So, what might loss distributions look like if you assume systemic effects, like a process hierarchy?</p>
<p>Let’s simulate an example, with some (I hope) reasonable assumptions. To start, assume a business process that is hierarchically organised, like the payments example above. Next, let’s say that loss events (errors, frauds, interruptions, etc.) occur in the business operations at a rate of, say 360 per year, with a systemic event about 4 times a year. If an event occurs at a higher level process, then it affects multiple lower-level transactions – in effect, it becomes multiple events.</p>
<p>We can model the systemic hierarchy using the <a href="http://richardderozario.org/posts/karyl/karyl.html">k-ary level probabilities</a> that I wrote about in an earlier post. Essentially, the k-ary hierarchy acts as an upper limit for the more random hierarchy that might exist in reality. The closest k-ary tree for our assumptions will have a group size of 100 and a maximum level of 3.</p>
<p>Experience shows that the impacts of operational losses are typically heavy-tailed (even without systemic events). I’ll chose the common lognormal distribution with a meanlog of 7 (about $1000) and standard deviation (log) of 2. For the purposes of analysis, the parameter choices don’t matter, except in relation to the systemic effects (more on that later).</p>
<p>For simplicity, we’ll keep the annual rate of events a constant, although for realistic models that would also be a random variable – typically Poisson or Negative Binomially distributed. Keeping the rate of events constant allows us to focus on the impact. With the systemic modification, the impact formulation can be summarised as:</p>
<p><span class="math">\[
Impact = \sum^K_i X
\]</span> where <span class="math">\(K\)</span> is a random variable following the k-rary level distribution and <span class="math">\(X\)</span> is a random variable following the log-normal distribution.</p>
<p>We’ll generate the results in a table, so that we can distinguish the systemic from single events.</p>
<pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">source</span>(<span class="st">&quot;../karyl/karyl.R&quot;</span>)  <span class="co"># use k-ary tree probability</span>
    <span class="kw">set.seed</span>(<span class="dv">123</span>)   <span class="co"># make this single simulation reproducible</span>
    
    gsize &lt;-<span class="st"> </span><span class="dv">100</span>    <span class="co"># group size</span>
    Lmax &lt;-<span class="st"> </span><span class="dv">3</span>       <span class="co"># max level</span>
    nSim =<span class="st"> </span><span class="dv">30</span>*<span class="dv">12</span>    <span class="co"># one year of events</span>
    Err &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Impact=</span>gsize^(Lmax-<span class="kw">rkaryl</span>(nSim,Lmax,gsize)), <span class="dt">Systemic=</span><span class="ot">FALSE</span>)
    Err$Systemic[Err$Impact&gt;<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
    Err$Impact &lt;-<span class="st"> </span><span class="kw">sapply</span>(Err$Impact,function(i){<span class="kw">sum</span>(<span class="kw">rlnorm</span>(i,<span class="dt">meanlog=</span><span class="dv">7</span>,<span class="dt">sdlog=</span><span class="dv">2</span>))})</code></pre>
<p>The distribution of the impact of the errors is easiest to see on a log-scale. In addition to the histogram, I’ll draw some red vertical lines so that we can see where the systemic losses are.</p>
<pre class="sourceCode r"><code class="sourceCode r">    <span class="co"># distribution of loss event impact</span>
    <span class="kw">source</span>(<span class="st">&quot;../loglabels/loglabels.R&quot;</span>)
    br&lt;-<span class="kw">hist</span>(<span class="kw">log</span>(Err$Impact,<span class="dv">10</span>),<span class="dt">axes=</span>F,
        <span class="dt">main=</span><span class="st">&quot;systemic loss effect&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;log of impact&quot;</span>)$breaks
    <span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>br,<span class="dt">labels=</span><span class="kw">loglabels</span>(br))
    <span class="kw">axis</span>(<span class="dv">2</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">log</span>(Err$Impact[Err$Systemic==<span class="ot">TRUE</span>],<span class="dv">10</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre>
<div class="figure">
<img src="figure/hist-1.png" />
</div>
<p>As the histogram shows, the systemic events are in the tail. You’d expect that, because impact of a systemic event is a multiple of the impact of single events. However, if the single events have a heavily skewed distribution, such as a log-normal, the expected loss of an individual transaction is usually a lot lower than the larger losses. This means that the systemic event can be expected to be a multiplication of small(er) losses, which probably means that the size of the systemic events overlaps with the tail of the individual events.</p>
<p>Now, with relatively few systemic events that affect many (but not usually close to all) transactions, would we detect them by just looking at the historical impact data? To get a better sense of this, let’s simulate many years of just single loss events, as well as years of combined single and systemic events.</p>
<figure>
<pre class="sourceCode r"><code class="sourceCode r">    <span class="co"># qqplot of single and combined single &amp; systemic losses</span>
    x &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">sum</span>(<span class="kw">rlnorm</span>(nSim, <span class="dt">meanlog=</span><span class="dv">7</span>, <span class="dt">sdlog=</span><span class="dv">2</span> )))
    
    y &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">sum</span>(<span class="kw">rlnorm</span>(
        gsize^(Lmax-<span class="kw">rkaryl</span>(nSim,Lmax,gsize)),
        <span class="dt">meanlog=</span><span class="dv">7</span>, <span class="dt">sdlog=</span><span class="dv">2</span>)))
        
    <span class="kw">qqplot</span>(x,y,
        <span class="dt">main=</span><span class="st">&quot;single vs. systemic &amp; single losses&quot;</span>,
        <span class="dt">xlab=</span><span class="st">&quot;single losses&quot;</span>, 
        <span class="dt">ylab=</span><span class="st">&quot;single &amp; systemic losses&quot;</span>)
        
    <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre>
<img src="figure/comparison-1.png" />
<figcaption>
<em>Figure 1. distribution comparison: qqplot of single vs. systemic &amp; single losses</em>
</figcaption>
</figure>
<p>With a straight comparison of many years single vs. combined systemic and single loss events, we should be able to detect the difference. As <em>Figure 1</em> shows, the distributions look the same for lower value losses, but the combined distribution has more higher value losses.</p>
<p>However, in practice there are far fewer years to compare and the annual rate of losses varies. Below is the comparison again, but now taking into account those more realistic aspects.</p>
<figure>
<pre class="sourceCode r"><code class="sourceCode r">    <span class="co"># qqplot of single and combined single and systemic losses</span>
    x &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">500</span>, <span class="kw">sum</span>(<span class="kw">rlnorm</span>(<span class="kw">rpois</span>(<span class="dv">1</span>,nSim), <span class="dt">meanlog=</span><span class="dv">7</span>, <span class="dt">sdlog=</span><span class="dv">2</span> )))
    
    y &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">500</span>, <span class="kw">sum</span>(<span class="kw">rlnorm</span>(
        gsize^(Lmax-<span class="kw">rkaryl</span>(<span class="kw">rpois</span>(<span class="dv">1</span>,nSim),Lmax,gsize)),
        <span class="dt">meanlog=</span><span class="dv">7</span>, <span class="dt">sdlog=</span><span class="dv">2</span>)))
        
    <span class="kw">qqplot</span>(x,y,
        <span class="dt">main=</span><span class="st">&quot;single vs. systemic &amp; single losses&quot;</span>,
        <span class="dt">xlab=</span><span class="st">&quot;single losses&quot;</span>, 
        <span class="dt">ylab=</span><span class="st">&quot;single &amp; systemic losses&quot;</span>)
        
    <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre>
<img src="figure/comparison2-1.png" />
<figcaption>
<em>Figure 2. qqplot of single vs. systemic &amp; single losses: less data and random rate</em>
</figcaption>
</figure>
<p>In the case illustrated in <em>Figure 2</em>, the differences in the tail are less clear. We could well decide that the tail differences are just outliers and that the data fits a lognormal distribution of single events.</p>
<p>The problem of sparsity of tail events (by definition) is well known and most loss-distribution models in practice try to model the tail separately. However, most loss-distribution approaches do not, as far as I know, try to capture the underlying mechanism, such as systemic loss events, that might explain why the tail is different. Without representing such mechanisms, the models are risking their validity.</p>
<div class="references">

</div>

<!-- GOOGLE ANALYTICS -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60473518-1', 'auto');
  ga('send', 'pageview');

</script>

<!--DISQUS DON'T REMOVE THIS COMMENT-->
 <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'richardderozario'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    
 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'richardderozario'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</body>
</html>
